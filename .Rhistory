data <- as.data.frame(table(df[[i]][,call]))
#        color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind.data.frame(mat, out)
color <- NULL
out <- NULL
}
x
c
y
i <- 1
data <- as.data.frame(table(df[[i]][,call]))
#        color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind.data.frame(mat, out)
mat <- NULL
data <- as.data.frame(table(df[[i]][,call]))
#        color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind.data.frame(mat, out)
i <- 2
data <- as.data.frame(table(df[[i]][,call]))
#        color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind.data.frame(mat, out)
mat <- NULL
i <- 1
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind.data.frame(mat, out)
i <- 2
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind.data.frame(mat, out)
View(mat)
out
mat <- NULL
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
}
mat <- as.data.frame(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
ggplot(melt, aes(x=colorBy, y=value)) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
ggplot(melt, aes(x=colorBy, y=as.numeric(value))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
clonalDiversity <- function(df,
call = c("gene", "nt", "aa"),
colorBy = "samples") {
if (call == "gene") {
call <- "CTgene"
} else if(call == "nt") {
call <- "CTnt"
} else {
call <- "CTaa"
}
mat <- NULL
if (colorBy == "samples") {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z)
mat <- rbind.data.frame(mat, out)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE")
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
plot <- ggplot(melt, aes(x, y=value)) +
geom_jitter(shape=21, size=3, width=0.2, aes(fill=melt[,colorBy]))
} else {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
mat <- as.data.frame(mat)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
plot <- ggplot(melt, aes(x=colorBy, y=as.numeric(value))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
}
col <- length(unique(melt[,colorBy]))
plot <- plot +
ylab("Index Score") +
scale_fill_manual(name = colorBy, values = colorblind_vector(col)) +
facet_wrap(~variable, scales = "free", ncol = 4) +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
return(plot)
}
clonalDiversity(df, call = "gene", colorBy = "samples")
clonalDiversity(df, call = "gene", colorBy = "ID")
clonalDiversity <- function(df,
call = c("gene", "nt", "aa"),
colorBy = "samples") {
if (call == "gene") {
call <- "CTgene"
} else if(call == "nt") {
call <- "CTnt"
} else {
call <- "CTaa"
}
mat <- NULL
if (colorBy == "samples") {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z)
mat <- rbind.data.frame(mat, out)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE")
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
plot <- ggplot(melt, aes(x, y=value)) +
geom_jitter(shape=21, size=3, width=0.2, aes(fill=melt[,colorBy]))
} else {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
mat <- as.data.frame(mat)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
plot <- ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(value))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
}
col <- length(unique(melt[,colorBy]))
plot <- plot +
ylab("Index Score") +
scale_fill_manual(name = colorBy, values = colorblind_vector(col)) +
facet_wrap(~variable, scales = "free", ncol = 4) +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
return(plot)
}
clonalDiversity(df, call = "gene", colorBy = "samples")
clonalDiversity(df, call = "gene", colorBy = "ID")
View(melt)
melt[,colorBy]
ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(value))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
clonalDiversity <- function(df,
call = c("gene", "nt", "aa"),
colorBy = "samples") {
if (call == "gene") {
call <- "CTgene"
} else if(call == "nt") {
call <- "CTnt"
} else {
call <- "CTaa"
}
mat <- NULL
if (colorBy == "samples") {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z)
mat <- rbind.data.frame(mat, out)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE")
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
plot <- ggplot(melt, aes(x, y=value)) +
geom_jitter(shape=21, size=3, width=0.2, aes(fill=melt[,colorBy]))
} else {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
mat <- as.data.frame(mat)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
plot <- ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(melt[,value]))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
}
col <- length(unique(melt[,colorBy]))
plot <- plot +
ylab("Index Score") +
scale_fill_manual(name = colorBy, values = colorblind_vector(col)) +
facet_wrap(~variable, scales = "free", ncol = 4) +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
return(plot)
}
clonalDiversity(df, call = "gene", colorBy = "samples")
clonalDiversity(df, call = "gene", colorBy = "ID")
mat <- NULL
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
mat <- as.data.frame(mat)
}
View(mat)
mat <- NULL
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
mat <- as.data.frame(mat)
}
mat <- NULL
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
}
clonalDiversity <- function(df,
call = c("gene", "nt", "aa"),
colorBy = "samples") {
if (call == "gene") {
call <- "CTgene"
} else if(call == "nt") {
call <- "CTnt"
} else {
call <- "CTaa"
}
mat <- NULL
if (colorBy == "samples") {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z)
mat <- rbind.data.frame(mat, out)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE")
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
plot <- ggplot(melt, aes(x, y=value)) +
geom_jitter(shape=21, size=3, width=0.2, aes(fill=melt[,colorBy]))
} else {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
plot <- ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(melt[,value]))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
}
col <- length(unique(melt[,colorBy]))
plot <- plot +
ylab("Index Score") +
scale_fill_manual(name = colorBy, values = colorblind_vector(col)) +
facet_wrap(~variable, scales = "free", ncol = 4) +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
return(plot)
}
clonalDiversity(df, call = "gene", colorBy = "samples")
clonalDiversity(df, call = "gene", colorBy = "ID")
clonalDiversity <- function(df,
call = c("gene", "nt", "aa"),
colorBy = "samples") {
if (call == "gene") {
call <- "CTgene"
} else if(call == "nt") {
call <- "CTnt"
} else {
call <- "CTaa"
}
mat <- NULL
if (colorBy == "samples") {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z)
mat <- rbind.data.frame(mat, out)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE")
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
plot <- ggplot(melt, aes(x, y=value)) +
geom_jitter(shape=21, size=3, width=0.2, aes(fill=melt[,colorBy]))
} else {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
}
mat <- as.data.frame(mat)
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
plot <- ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(melt[,value]))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
}
col <- length(unique(melt[,colorBy]))
plot <- plot +
ylab("Index Score") +
scale_fill_manual(name = colorBy, values = colorblind_vector(col)) +
facet_wrap(~variable, scales = "free", ncol = 4) +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
return(plot)
}
clonalDiversity(df, call = "gene", colorBy = "samples")
clonalDiversity(df, call = "gene", colorBy = "ID")
mat <- NULL
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
}
View(mat)
mat <- as.data.frame(mat)
View(mat)
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(melt[,value]))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(value))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
clonalDiversity <- function(df,
call = c("gene", "nt", "aa"),
colorBy = "samples") {
if (call == "gene") {
call <- "CTgene"
} else if(call == "nt") {
call <- "CTnt"
} else {
call <- "CTaa"
}
mat <- NULL
if (colorBy == "samples") {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z)
mat <- rbind.data.frame(mat, out)
}
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE")
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = "samples")
plot <- ggplot(melt, aes(x, y=value)) +
geom_jitter(shape=21, size=3, width=0.2, aes(fill=melt[,colorBy]))
} else {
for (i in seq_along(df)) {
data <- as.data.frame(table(df[[i]][,call]))
color <- df[[i]][1,colorBy]
w <- vegan::diversity(data[,"Freq"], index = "shannon")
x <- vegan::diversity(data[,"Freq"], index = "invsimpson")
y <- vegan::estimateR(data[,"Freq"])[2] #Chao
z <- vegan::estimateR(data[,"Freq"])[4] #ACE
out <- c(w,x,y,z,color)
mat <- rbind(mat, out)
}
mat <- as.data.frame(mat)
colnames(mat) <- c("Shannon", "Inv.Simpson", "Chao", "ACE", colorBy)
rownames(mat) <- names(df)
mat$samples <- rownames(mat)
melt <- reshape2::melt(mat, id.vars = c("samples", colorBy))
plot <- ggplot(melt, aes(x=melt[,colorBy], y=as.numeric(value))) +
geom_boxplot(aes(fill=melt[,colorBy]), outlier.alpha = 0) +
geom_jitter()
}
col <- length(unique(melt[,colorBy]))
plot <- plot +
ylab("Index Score") +
scale_fill_manual(name = colorBy, values = colorblind_vector(col)) +
facet_wrap(~variable, scales = "free", ncol = 4) +
theme_classic() +
theme(axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank())
return(plot)
}
clonalDiversity(df, call = "gene", colorBy = "samples")
clonalDiversity(df, call = "gene", colorBy = "ID")
ggsave("Figure3D.eps", height=1.5, width=3)
ggsave("Figure3D.eps", height=2, width=5)
